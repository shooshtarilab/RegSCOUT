![logo](https://github.com/shooshtarilab/RegSCOUT/blob/main/images/RegSCOUT_logo.png)

# RegSCOUT (<ins>Reg</ins>ulatory <ins>S</ins>ingle <ins>C</ins>ell <ins>O</ins>mics for <ins>U</ins>nravelling <ins>T</ins>rait-Loci)
RegSCOUT is a computational pipeline that integrates disease-associated SNPs, identified through genome-wide association studies (GWAS), with scATAC-seq, Hi-C, eQTL, TF position frequency matrices (PFMs), scRNA-seq, and GENCODE gene annotation data. Through this comprehensive integrative approach, RegSCOUT prioritizes putative gene regulatory networks relevant to the pathogenesis of complex diseases. We have made RegSCOUT into an executable docker application for ease of use; however, RegSCOUT can also be run in bash, example bash scripts can be found on the github page in the bash_scripts folder. While this README will provide a general overview of the pipeline and how it can be run, <ins>it is highly recommended that users read the more comprehensive user manual on this github before using RegSCOUT</ins> (RegSCOUT_User_Manual.pdf).

## Required R version and libraries:
RegSCOUT can be run on R versions 4.4.x and 4.5.x. It requires these libraries: tools, Seurat, Signac, GenomicRanges, genetics.binaRies, R.utils, atSNP, TFBSTools, JASPAR2024, stringr, circlize, ComplexHeatmap, R.utils, monocle3, cicero, Repitools, reshape2, dplyr, purrr, BSgenome.Hsapiens.UCSC.hg19, BSgenome.Hsapiens.UCSC.hg38, rtracklayer, data.table, writexl, tidyr, and tibble. <ins>Monocle3 must be installed prior to installing cicero</ins> (cicero analysis will not run properly if not). Cicero should be installed following instructions found in this link: https://cole-trapnell-lab.github.io/cicero-release/docs_m3/. 

## Note about genome builds:
When using RegSCOUT please ensure that all files provided to this pipeline are in the same genome build. E.g., PLINK bfiles (.bed, .bim, .fam), GWAS summary statistics, GWAS lead SNPs, GWAS locus region information, fine-mapped GWAS data, scATAC-seq datasets, Hi-C datasets, eQTL datasets, histone mark results datasets, and GENCODE gene information. RegSCOUT does not perform the lifting over of genome coordinates from one genome annotation version to another, this must be done prior to use of the pipeline. 

## Important Notes When Using RegSCOUT
1.	All directories specified in parameters passed to RegSCOUT should end with “/”. 
2.	Downstream stages of the pipeline will not work if the --mode parameter is not used (see sections 1.5, 4, and 5 of this manual). Please ensure you select a mode for RegSCOUT and provide scATAC-seq data to the pipeline.
3.	Please note that case (lower/upper case) matters in all aspects of this pipeline (parameters, column names for input files, etc.). Please keep this in mind when using parameters and creating input files, for example. 
4.	When providing numerical values to parameters, do not incorporate commas or spaces for thousands, e.g., use 100000 not 100,000.
5.	All chromosome numbers provided in files to RegSCOUT must be of the following naming convention 'chr' + 'number' (no space between). For example: chr8.
6.	Please see below explanation of mandatory RegSCOUT parameter:

| Parameter | Purpose and Potential Values | Default Value | 
| --------- | ---------------------------- | ------------- | 
| --output_dir | This parameter should specify the directory in which the user would like all outputs to be stored by RegSCOUT. This parameter should always be defined by the user. An ‘images’ folder will be created in this directory to store all figures generated by the pipeline. If this folder is already present in this directory, it will be overwritten. | No default, must be set by user. |

7.  Please see below explanations of important terms:

| Term | Definition | 
| ---- | ---------- | 
| Effect-SNPs | Fine-mapped SNPs that significantly influence the binding affinity of one or more TFs. |
| Risk-Mediating Peaks | Open chromatin regions in which one or more effect-SNPs colocalize (fall in the region). |

## Pipeline Overview
![Pipeline Overview](https://github.com/shooshtarilab/RegSCOUT/blob/main/images/Workflow_schematic.png)

Above is a general overview of the RegSCOUT workflow. Please note that certain parameters with defaults will not be explained in this README; intermediate outputs may not be explained as well. Enough information will be provided to run the pipeline; however, for a more comprehensive overview of each step, please see the user manual on this github. In the following sections of this README, descriptions of key parameters, inputs, and outputs, for each step, will be provided. Although the steps shown in the figure are numbered sequentially from 1-8, many are optional and dependent on what data is available to the user. 
- If --mode *peak_table* is requested, step 3 will not be run. 
- If the --finemap parameter is not specified, steps 1 & 2 will not run. 
- If the --hic_analysis parameter is not specified, step 5b will not run.
- If the --eqtl_analysis parameter is not specified, step 5c will not run.
- If the --histone_mark_analysis parameter is not specified, step 6 will not run.
- If the --tf_expr_analysis parameter is not specified, step 7 will not run.

## Fine-mapping Requested by User (--finemap Y; Steps 1 and 2)
To request that fine-mapping be conducted, the user must set the --finemap parameter to *Y*. RegSCOUT will perform preprocessing of GWAS summary statistics, create loci, and use fgwas (https://github.com/joepickrell/fgwas) to perform fine-mapping. These fine-mapping results will be integral to running subsequent steps of the RegSCOUT pipeline. 

### <ins>Parameters</ins>
| Parameter | Purpose and Potential Values | Default Value | 
| --------- | ---------------------------- | ------------- | 
| --finemap | Set this parameter to *Y* if fine-mapping should be conducted by RegSCOUT using fgwas. If fine-mapping is not desired (i.e., the user already has fine-mapping results), this parameter should not be used. | Analysis not conducted |
| --snp_ref_dir | Specifies the directory containing the bfiles used for PLINK preprocessing of GWAS data and LD analysis to identify loci. | No default, must be set by user |
| --population | Specifies the population/ancestry that the bfiles were created from (e.g., EUR, EAS). | No default, must be set by user |
| --sum_stats_dir | Specifies the path to the GWAS summary statistics. | No default, must be set by user |
| --lead_snps_dir | Specifies the path to GWAS lead SNP information. | No default, must be set by user |
| --plink2_dir | Specifies the path to the Plink2 executable. | No default, must be set by user |
| --sample_num | Sample size (total number of cases and controls) of the GWAS. If a sample size column (N) with sample size for each SNP is provided in the GWAS summary statistics, this parameter should be set to *present*. Alternatively, an integer value can be provided in this parameter to specify a constant overall sample size of the GWAS, this should only be provided if a sample size for each SNP is not readily available. | *present* |
| --fgwas_dir | Specifies the path to the fgwas executable. | No default, must be set by user |

### <ins>Input files</ins>

### GWAS Summary Statistics
The path to the summary statistics file should be specified using --sum_stats_dir. This file must be tab-separated and contain at least these 4 columns (note that RegSCOUT is case sensitive): ‘SNP’ (containing SNP rsIDs), ‘CHR’ (chromosome of the SNP), ‘POS’ (position of SNP on chromosome), and ‘P’ (p-value of association of SNP to disease). The following columns are not necessary but will be used by RegSCOUT if present: ‘A1’ (reference allele of SNP), ‘A2’ (alternative allele of SNP), ‘MAF’ (minor allele frequency of SNP), and ‘N’ (sample size). 

If the sample size column (‘N’) is present in the summary statistics, the --sample_num parameter should be set to present; however, if it is not, and the user is not able to find a sample size for each SNP, the overall sample size of the GWAS study should be provided using the --sample_num parameter (e.g., --sample_num 190000). Providing the ‘N’ column in the summary statistics is preferable and highly recommended.

If one of A1, A2, or MAF are missing from the GWAS summary statistics file, each of these columns will be filled in using Plink2 and its required bfiles (.bim, .bed, .fam). More information regarding these bfiles can be found below.

### GWAS Lead SNPs
The path to this file should be specified using --lead_snps_dir. This file must be tab-separated (.txt or .tsv) if containing more than one column; however, only one column in this file is necessary for the pipeline to run: ‘SNP’ (containing lead SNP rsIDs). 

### Plink bfiles
The path to these files are specified by the combination of the --snp_ref_dir and --population parameters. The file suffixes are not required in the path to these files, thus an example file path used by RegSCOUT is '/user/bin/EUR'. These are the .bim, .bed, and .fam files (e.g., EUR.bim, EUR.bed, and EUR.fam) required to run Plink2 to fill in reference/alternative allele as well as minor allele frequency information. These files will also be used to calculate LD values and group SNPs into loci. These files, in hg19, can be downloaded from here: https://mrcieu.github.io/gwasglue/ (see updated 1000 genomes reference panels). Users can also provide bfiles that they have generated, in hg38, or for the specific group they want to study.

### <ins>Output Files</ins>
| Output file | Description |
| ----------- | ----------- |
| final_gwas_data.txt | A tab-separated file organized by increasing locus number. This file is provided to fgwas for fine-mapping. There are 9 columns: ‘SNPID’ (the rsID of a SNP), ‘CHR’ (the chromosome the SNP is found on), ‘POS’ (the position of the SNP on the chromosome), ‘Z’ (the associated Z-score of the SNP), ‘F’ (the SNP's minor allele frequency), ‘N’ (sample size), ‘SEGNUMBER’ (locus number), ‘A1’ (reference allele of SNP), and ‘A2’ (alternative allele of SNP). |
| gwas_CI.txt | A tab-separated file which contains the results of fine-mapping and filtering for --ci_th. SNPs on sex chromosomes and with PPA values <= --ci_ppa_th have also been filtered out. These are the credible interval SNPs. |

## Fine-mapping Already Conducted (--finemap not used)
In the case that fine-mapping results have already been obtained by the user, those results should be provided to RegSCOUT and the --finemap parameter should not be used. **The path to this file must be specified by the --ci_gwas_dir parameter.** The fine-mapping results file must contain credible interval SNPs, where, for each locus, the smallest number of SNPs whose cumulative PPAs add up to a certain threshold is provided (e.g., 0.95; this threshold is up to the user). The file does not have a specific naming convention that it must follow but must be a tab-separated file (.txt or .tsv). This file must have at least 7 columns labelled: ‘id’ (SNP rsID), ‘pos’ (SNP base pair position), ‘chr’ (SNP chromosome), ‘chunk’ (locus number), ‘PPA’ (SNP PPA), ‘a1’ (SNP reference allele), and ‘a2’ (SNP alternative allele). Other columns that are optional but, if present, will be included in the final tables generated in step 8 (gene prioritization) of the pipeline are: 'lead_snp' (the lead SNP of a locus), 'locus_chr' (locus chromosome number e.g., chr8 - chromosome numbers must follow this naming convention), 'locus_start' (start position of the locus), and 'locus_end' (end position of the locus). It is recommended that users provide this additional information about lead SNPs and loci. 

When creating this file please ensure that each SNP present in the file has <ins>just one reference and alternative allele</ins> listed in the ‘a1’ and ‘a2’ columns, respectively. Not doing so can cause errors when integrating SNP and TF motif data, an integral part of the RegSCOUT pipeline.

## Mode set to peak_table (--mode peak_table; Steps 4 and 5a)
The peak_table option should only be used if the user has already identified cell type-specific open chromatin regions and has already run cicero on their data to establish peak-to-peak links. If this is not the case, please see the section on --mode set to *ATAC_obj*. If the user has specified the *peak_table* option for RegSCOUT, this means that RegSCOUT will not be identifying cell type-specific open chromatin regions based on a certain threshold (e.g., a region must be open in 10% of cells of a cell type). RegSCOUT will also not be running cicero analysis to link open chromatin regions to each other as both these analyses must have already been conducted by the user. Instead, the user must provide both a peak-cell type table and cell type-specific co-accessibility tables (output of cicero) to RegSCOUT in the directory specified by the --output_dir parameter. More information on these tables and their formats can be found in the input files section.

### <ins>Parameters</ins>
| Parameter | Purpose and Potential Values | Default Value | 
| --------- | ---------------------------- | ------------- | 
| --mode | The user must indicate whether they have a scATAC-seq Seurat object or if they have a table of open chromatin regions as well as cicero results already generated. If the user is providing a Seurat object, this parameter should be set to *ATAC_obj*. If the user is providing a peak table and cicero results, this parameter should be set to *peak_table*. | No default, must be set by user |
| --ci_gwas_dir | Only use this parameter if fine-mapping was not conducted by RegSCOUT. Specifies the path to fine-mapping results. | If fine-mapping was not conducted by RegSCOUT: no default, must be set by user |
| --genome_build | The human reference genome that RegSCOUT should conduct analyses in, either *hg19* or *hg38*. | No default, must be set by user |
| --gencode_dir | Specifies the path to GENCODE gene annotation file downloaded from the GENCODE website (https://www.gencodegenes.org). | No default, must be set by user |
| --jaspar_mtx_dir | Specifies the path to a user provided file with JASPAR TF PFMs. If set to *none*, the JASPAR2024 R library will be used to obtain TF PFMs. | *none* |

### <ins>Input files</ins>

### Peak-Cell Type Table
The path to this file need not be specified, RegSCOUT will look for this file in the directory defined by the --output_dir parameter. This file must be a tab-separated file (.tsv) named **cell_peak.tsv**. The table should have four columns: ‘chr’, ‘start’, ‘end’, and ‘cell_types’. Each row will represent one region of chromatin that was identified to be open. The ‘cell_types’ column will be a comma-separated list of all cell types in which the chromatin region on the same row was identified to be open. In the ‘cell_types’ column, there should be no spaces after each comma. 

Example peak-cell type table:
| chr | start | end | cell_types | 
| ---- | ----- | --- | -------------- | 
| chr1 | 123 | 1000 | plasma_cells,memory_b_cells | 
| chr11 | 2000 | 2600 | naive_CD8_T_cells,naive_CD4_T_cells | 
| chr18 | 1 | 678 | classical_monocytes,nonclassical_monocytes | 

### Cell Type-Specific Co-Accessibility Tables
The path to these files need not be specified as RegSCOUT will look for these files in the directory defined by the --output_dir parameter. These should be the output of cicero after filtering for a certain co-accessibility/significance threshold. RegSCOUT will not perform this filtering if --mode peak_table was selected. There will be one table for each of the cell types investigated. The names of each cell type-associated file should follow this naming convention: [cell type name].filtered_coaccessible_sites4s.txt (e.g., plasma_cells.filtered_coaccessible_sites4s.txt). These tables should be tab-separated and should have three columns named ‘Peak1’, ‘Peak2’, and ‘coaccess’ (co-accessibility value between peak1 and peak2 calculated by cicero). The Peak1 and Peak2 columns should contain underscore-separated locations of open chromatin regions (e.g., chr1_2000_2600).

Example cell type-specific co-accessibility table:
| Peak1 | Peak2 | coaccess | 
| ---- | ---- | ----- | 
| chr1_1000_1600 | chr1_2000_2600 | 0.13 |
| chr3_3000_4000 | chr3_5000_5500 | 0.27 |

### GENCODE Gene Annotation File
The user must provide a GENCODE gene annotation file downloaded from the GENCODE website: https://www.gencodegenes.org. The path to this file should be specified using the --gencode_dir parameter. Users should download the appropriate .gff3 file in the genome build that all other input files are in. The .gff3 file should be a comprehensive gene annotation file. RegSCOUT will filter this gene annotation file for specifically the protein coding gene transcripts present and use those transcripts for subsequent analyses, including defining promoter regions.

### JASPAR TF PFM File
In conducting SNP and TF motif integration, RegSCOUT uses the JASPAR TF binding motif database (https://jaspar.elixir.no). If the user would prefer not to create a comprehensive JASPAR TF PFM file themselves, the jaspar_mtx_dir parameter can be set to *none* (i.e., --jaspar_mtx_dir none). This is the default value of this parameter. RegSCOUT, in this case, will obtain PFMs using the JASPAR2024 R library (https://bioconductor.org/packages/release/data/annotation/html/JASPAR2024.html). If users wish to provide their own file containing JASPAR TF PFMs, the path to this file should be specified using the --jaspar_mtx_dir parameter. To create this file, the user must download position frequency matrices (PFMs) from the JASPAR website and place them into a single file. A file which contains 755 human TF PFMs from the CORE JASPAR collection (combined_755_motifs_jaspar2024.txt) will be placed in the example_files folder on the github.

### <ins>Output files</ins>
| Output file | Description |
| ----------- | ----------- |
| Ci_effect_SNPs.txt | A tab-separated file containing all identified effect-SNPs, fine-mapped SNPs that significantly impacted the binding affinity of at least one TF, and their associated TFs. This file has 9 columns: ‘SNP’ (the rsID of a SNP), ‘CHR’ (the chromosome the SNP is found on), ‘Pos’ (the position of the SNP on the chromosome), ‘Locus’ (locus number), ‘TF’ (TF whose binding affinity was significantly impacted by the SNP), ‘Raw_P_value’ (p-value before FDR correction), ‘FDR_corr_P_value’ (p-value after FDR correction), 'log_like_ratio' (the log likelihood ratio comparing the impact of the alternative allele of a SNP on TF binding affinity compared to the reference allele), and 'ppa' (PPA of SNP). A positive log likelihood ratio indicates that the alternative allele increases TF binding affinity compared to the reference allele. A negative log likelihood ratio indicates the alternative allele decreases TF binding affinity compared to the reference allele. |
| cell_peak.svg | A visual representation of risk_regions_ppa.txt. This heatmap shows risk-mediating peaks on the y-axis and cell types on the x-axis. A heatmap square shaded in red indicates that a certain risk-mediating peak was found in a specific cell type whereas if a square is shaded in white, that risk-mediating peak was not found in that cell type. The bar on the right of this heatmap with shades of purple shows the sum of the PPAs of all effect-SNPs that fall into a risk-mediating peak (sumPPA). |
| cell_snp_tf.svg | A visual representation of risk_regions_ratio.txt specific to TF-SNP pairs. This heatmap shows TF-SNP pairs on the y-axis and cell types on the x-axis. A heatmap square shaded in blue indicates that a certain TF-SNP pair was found relevant to a specific cell type whereas if a square is shaded in white, that TF-SNP pair was not found relevant to that cell type. The bar on the right of this heatmap with shades of orange shows the log likelihood ratio value obtained for each TF-SNP pair. Further explanation of log likelihood ratio values can be found above where Ci_effect_SNPs.txt is described. In this case, absolute valued log likelihood ratios are shown. |
| direct_rmp_gene_overlaps.txt | This is a table of all risk-mediating peak and gene promoter (as defined by GENCODE) overlaps identified, output as a tab-separated text file. There are 4 columns: 'RMP' (the risk-mediating peak), 'Promoter' (the promoter region defined using GENCODE), 'Gene' (the gene associated with that promoter), and 'Cell_Type' (the cell type in which the risk-mediating peak was identified). |
| cic_peak_interact_gene.txt | Table that shows links between RMPs and their target genes using peak-peak links identified by cicero, output as a tab-separated text file. This table has 6 columns: 'Peak1' (A risk-mediating peak), 'Peak2' (The peak that co-localized with a gene's promoter), 'coaccess' (the coaccessibility value calculated by cicero between Peak1 and Peak2), 'Promoter' (the promoter region defined using GENCODE), 'Gene' (the gene associated with that promoter), and 'Cell_Type' (the cell type in which this RMP-gene link was identified). |
| cell_gene_matrix.txt | A binary matrix that shows genes as columns and cell types as rows. A ‘1’ indicates that a gene was found relevant to a cell type according to risk-mediating peak and gene promoter linkage with cicero results, or by direct co-localization of a risk-mediating peak with a gene's promoter. A ‘0’ indicates that a gene was not found relevant to a cell type according to those criteria. |

## Mode set to ATAC_obj (--mode ATAC_obj; Steps 3, 4, and 5)
The *ATAC_obj* option should be used when the user has a scATAC-seq dataset that they would like RegSCOUT to use to identify risk-mediating open chromatin regions and run cicero analysis. More information on how this scATAC-seq dataset should be formatted can be found below. In this case, RegSCOUT will identify open chromatin regions in the scATAC-seq dataset based on a threshold that can be set by the user. RegSCOUT will also run cicero analysis, how it conducts cicero analysis can also be modified by the user, see user manual for more details. 

### <ins>Parameters</ins>
Parameters listed below for --mode ATAC_obj are in addition to all parameters listed for --mode peak_table. In other words, the parameters relevant to --mode peak_table are a subset of those required for --mode ATAC_obj. 

| Parameter | Purpose and Potential Values | Default Value | 
| --------- | ---------------------------- | ------------- | 
| --seurat_obj_dir | Specifies the path to the scATAC-seq Seurat object. | No default, must be set by user |

### <ins>Input files</ins>

### scATAC-seq Seurat Object
The path to the scATAC-seq Seurat object should be provided using the --seurat_obj_dir parameter. The provided Seurat object should have an Assay named ‘peaks’ which holds a chromatin assay object created from the counts matrix of the scATAC-seq experiment. In addition, cell type labels should be provided as cell identities in the Seurat object (and accessible using the Idents() function of Seurat). This article provides more information on how to establish cell identities/class labels: https://satijalab.org/seurat/articles/essential_commands.html (under the ‘Identity class labels’ heading). The Seurat object can be provided to RegSCOUT as either an .RDS or .RData file. 

### GENCODE Gene Annotation File
See description of this file in 'Mode set to peak_table' section.

### JASPAR TF PFM File
See description of this file in 'Mode set to peak_table' section.

### <ins>Output files</ins>
Output files listed below are in addition to files output using --mode peak_table, please see 'Mode set to peak_table' section for more information on output files. The output files produced using --mode peak_table are a subset of those produced using --mode ATAC_obj.

| Output file | Description |
| ----------- | ----------- |
| cell_peak.tsv | Table that provides genomic locations of peaks considered open in certain cell types (i.e., those that met threshold set using the --peak_th parameter). This table will have four columns: ‘chr’ (the chromosome the open chromatin region is found on), ‘start’ (start position of the region), ‘end’ (end position of the region), and ‘cell_types’ (all cell types in which the peak was considered open). |
| [cell type name].filtered_coaccessible_sites4s.txt | These files are the outputs of cicero analysis. They will have three columns: ‘Peak1’, ‘Peak2’, and ‘coaccess’ (the co-accessibility value calculated between Peak1 and Peak2). Only peak-peak interactions with co-accessibility greater than the threshold set using --coaccess_th will be found in these files. One file will be output for each cell type in the scATAC-seq data. |

## Hi-C Analysis (--hic_analysis Y; Step 5b)
If analysis of Hi-C data, provided by the user, to assist in the prioritization of genes is desired, the user can set the --hic_analysis parameter to *Y*. 

### <ins>Parameters</ins>

| Parameter | Purpose and Potential Values | Default Value | 
| --------- | ---------------------------- | ------------- | 
| --hic_analysis | Set this parameter to Y if analysis of user-provided Hi-C data to assist in prioritization of genes is desired. If Hi-C analysis is not desired, do not use this parameter. | Analysis not conducted |
| --hic_instruct_dir | Specifies the path to user generated Hi-C analysis instructions file. | No default, must be set by user |

### <ins>Input files</ins>

### Hi-C Instructions File
This file must be provided to RegSCOUT as either a .tsv, .csv, or space/tab-separated .txt file. This must be a user-generated file which is used to inform RegSCOUT about how it should conduct Hi-C analysis. The instructions file needs to have 6 columns labelled: ‘hic_dir’, ‘genes_present’, ‘cell_sorted’, ‘atac_cell_types’, ‘hic_cell_types’, and ‘signif_threshold’. 

Each row of the instructions file will refer to one Hi-C dataset. The ‘hic_dir’ column will denote the path to the Hi-C dataset. The ‘genes_present’ column will indicate whether the Hi-C dataset contains genes linked to one of the two genomic regions, this column will have a value of either TRUE or FALSE. If set to FALSE, this means the Hi-C dataset does not contain any gene names (no promoter capture experiment or gene colocalization analysis was conducted). The ‘cell_sorted’ column will indicate whether a Hi-C dataset has > 1 cell type identified in it. This column will have values of TRUE or FALSE, if set to TRUE this means that > 1 cell type can be found in the dataset. If FALSE, that means the dataset only contains Hi-C information for a single cell type. The ‘atac_cell_types’ column indicates the cell types from scATAC-seq for which risk-mediating peak and gene interactions should be investigated using the Hi-C dataset. If there are multiple cell types, they should be comma, but not space, separated (see example below). The ‘hic_cell_types’ column should only be used when the Hi-C dataset has > 1 cell type. It should indicate what cell types in the Hi-C dataset will be used for Hi-C analysis in RegSCOUT. These cell types should also be comma, but not space, separated. Please note that the list of cell types in ‘atac_cell_types’ should correspond directly with the list in ‘hic_cell_types’. For example, if the user hopes to use one broad Hi-C cell type to provide evidence for two separate cell types identified in scATAC-seq, that Hi-C cell type can be listed twice in the same order that the scATAC-seq cell types are listed. An example of this case can be seen in the example instructions table below (see second row). Finally, the ‘signif_threshold’ column can be left blank, unless ‘cell_sorted’ is set to TRUE (the dataset has > 1 cell type). In this case, RegSCOUT will filter Hi-C results for significance according to the threshold provided in this column, in a cell type-specific manner (this is the only case where RegSCOUT will filter a user-provided dataset for significance). RegSCOUT will expect Hi-C dataset column names to include cell type names, where for each cell type, significance scores are provided under its associated column. RegSCOUT can filter based on CHiCAGO scores as well as p-values and will automatically detect which has been provided (if signif_threshold is >= 1, it is assumed to be filtering for CHiCAGO scores). An example of a Hi-C instructions file can be found in the instruction_files folder on the github.






